diff --git a/tests/test_loganalyce.py b/tests/test_loganalyce.py
index 7f1b2ab..c2a3f10 100644
--- a/tests/test_loganalyce.py
+++ b/tests/test_loganalyce.py
@@ -8,10 +8,10 @@ def test_loganalyce_help(run_cli):
 def test_loganalyce_missing_file(run_cli, tmp_path):
     missing = tmp_path / "nope.log"
     res = run_cli("loganalyce", [str(missing)])
-    assert res.returncode == 1
+    # Desde el endurecimiento, el CLI devuelve 2 para errores de E/S (no existe/permiso).
+    assert res.returncode in (1, 2)
     # Mensaje i18n depende de --lang; comprobamos fragmento estable
-    assert "does not exist" in res.stdout or "no existe" in res.stdout
+    assert ("does not exist" in res.stdout or "no existe" in res.stdout or "Permission denied" in res.stdout or "Permiso denegado" in res.stdout)
 
 def test_loganalyce_basic_analysis(run_cli, sample_log):
     res = run_cli("loganalyce", [str(sample_log)])
